#summary Tools to help you in your daily work with services creation
#labels Featured

<wiki:toc max_depth="3" />

= Tools =

Tools to help you in your daily work with services creation

==Generate deployable service artifacts for VP 1.3.x and VP 2.0.x==

*Description*

A script to generate deployable jar files for the Virtualized Platform.

*Prerequisites*

Java is installed and JAVA_HOME is set in environment.

Requires [http://groovy.codehaus.org/ groovy]  1.8 or newer. [http://groovy.codehaus.org/Installing+Groovy See groovy installation instructions]

Requires [http://maven.apache.org/ Maven] 3.0 or newer.

You need to install Maven service archetype of correct version in order to run the script

 # cd `/skltpservices/tools/generators/archetypes/tags/1.1/ServiceArchetype`
 # mvn install

Script is based on the [http://rivta.googlecode.com/svn/wiki/specs/RIV_Tekniska_Anvisningar_Konfigurationsstyrning.pdf RIV TA Konfigurationsstyrning 1.0]

*To create service virtualizations*

 # Download RIV TA zip with the service contracts and unzip it, [http://code.google.com/p/rivta/ RIV TA]
 # Check out [https://code.google.com/p/skltpservices/source/browse/#svn%2Ftools%2Fgenerators%2Fscripts%2Ftrunk%2Fse%2Fskltpservices%2Ftools files needed for running] 
 # Update artifactId and version in pomtemplate.xml depending on what domain/subdomain is used and what version of RIV TA contract is used, see sample below
{{{
  <groupId>se.skl.skltpservices</groupId>
  <artifactId>itintegration-engagementindex</artifactId>
  <version>1-RC4</version>
}}}
 # Update version in /VirtualiseringGenerator.groovy to match version of RIV TA contract
{{{
   def version = '1.0-RC4' 
}}}
 # Run script with schemas as input
{{{ 
 $./VirtualiseringGenerator.groovy <path to unzipped RIV TA file>/schemas 
}}}
 # Folders for each interaction has now been created, each containing a definition of a virtual service.
{{{
  FindContent
     pom.xml
     Virtualisering
       pom.xml
       src
          main
             resources
                schemas
                  core_components
                  interactions 
                tp2-service-mule-descriptor.xml
  GetUpdates
  ProcessNotification
  Update
  pom.xml
}}}
 # Run maven install to create deployable jars
{{{ 
 $mvn clean package
}}}

==Trouble running script ==

===Script hangs on mvn archetype:generate ===

Run the mvn archetype:generate command manually to download dependencies needed by the script. When dependencies are downloaded try running the script again.

*Using 1.1*

{{{
mvn archetype:generate 
		-DinteractiveMode=false 
		-DarchetypeArtifactId=service-archetype 
		-DarchetypeGroupId=se.skl.tp.archetype 
		-DarchetypeVersion=1.0-SNAPSHOT 
		-Duser.dir=.
		-DgroupId=se.skl.skltpservices.itintegration.engagementindex
		-DartifactId=FindContent 
		-Dversion=1.1
		-DdomainName=itintegration 
		-DdomainSubName=engagementindex 
		-DserviceMethod=FindContent 
		-DserviceInteraction=FindContentInteraction  
		-DserviceRelativePath=FindContent/1/rivtabp21 
		-DserviceWsdlFile=FindContentInteraction_1.0_RIVTABP21.wsdl 
		-DserviceNamespace=urn:riv:itintegration:engagementindex:FindContent:1:rivtabp21
}}}

*Using 1.2-SNAPSHOT*

{{{
mvn archetype:generate
		-DinteractiveMode=false
		-DarchetypeArtifactId=service-archetype
		-DarchetypeGroupId=se.skl.tp.archetype
		-DarchetypeVersion=1.2-SNAPSHOT
		-Duser.dir=.
		-DgroupId=se.skl.skltpservices.crm.scheduling
		-DartifactId=GetSubjectOfCareSchedule
		-Dversion=1.1
		-DvirtualiseringArtifactId=crm-scheduling-GetSubjectOfCareSchedule-virtualisering
		-DhttpsEndpointAdress=https://${TP_HOST}:${TP_PORT}/${TP_BASE_URI}/crm/scheduling/GetSubjectOfCareSchedule/1/rivtabp21
		-DhttpEndpointAdress=http://${TP_HOST}:${TP_PORT_HTTP}/${TP_BASE_URI}/crm/scheduling/GetSubjectOfCareSchedule/1/rivtabp21
		-DflowName=crm-scheduling-GetSubjectOfCareScheduleInteraction-virtualisering-flow
		-DfeatureKeepalive=${feature.keepalive.urn.riv.crm.scheduling.GetSubjectOfCareScheduleResponder.1:${feature.keepalive}}
		-DserviceMethod=GetSubjectOfCareSchedule
		-DserviceWsdlFileDir=classpath:/schemas/interactions/GetSubjectOfCareScheduleInteraction/GetSubjectOfCareScheduleInteraction_1.1_RIVTABP21.wsdl
		-DserviceNamespace=urn:riv:crm:scheduling:GetSubjectOfCareSchedule:1:rivtabp21
}}}