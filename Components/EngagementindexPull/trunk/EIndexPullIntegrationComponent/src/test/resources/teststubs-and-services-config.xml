<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesource.org/schema/mule/core/2.2"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
      xmlns:spring="http://www.springframework.org/schema/beans"
      xsi:schemaLocation="
		http://www.springframework.org/schema/beans    http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
		http://www.mulesource.org/schema/mule/core/2.2 http://www.mulesource.org/schema/mule/core/2.2/mule.xsd"
      xmlns:http="http://www.mulesource.org/schema/mule/cxf/2.2">

	<spring:beans>
		<spring:import resource="classpath:EngagementIndexPull-config.xml" />
		<spring:import resource="classpath:teststub-services/*-teststub-service.xml" />
	</spring:beans>

    <!-- Data source -->
    <spring:bean id="eiPullStatusDbName" name="eiPullStatusDbName" class="java.lang.String">
        <spring:constructor-arg value="${ei.pull.status.db.name}"/>
    </spring:bean>
    <spring:bean id="eiPullDataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <spring:property name="driverClassName" value="${ei.pull.status.db.driver}"/>
        <spring:property name="url" value="${ei.pull.status.db.url}"/>
        <spring:property name="username" value="${ei.pull.status.db.user}"/>
        <spring:property name="password" value="${ei.pull.status.db.password}"/>
    </spring:bean>

    <model name="statusViewModel">
        <service name="statusViewService">
            <inbound>
                <inbound-endpoint address="jersey:${ei.pull.status.address}" synchronous="true"/>
            </inbound>
            <component>
                <spring-object bean="statusView" />
            </component>
        </service>
    </model>

</mule>