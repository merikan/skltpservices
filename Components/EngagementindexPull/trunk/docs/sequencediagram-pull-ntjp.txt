title Engagemangsindex - Pullfunktion NTjP utan RTP

note over EI_Pull, NTjP
H�mta logiska adresser som konsument f�r g�ra getUpdates p�:
Konsument HSA ID: HSASERVICES-100M
Tj�nstekontrakt: urn:riv:itintegration:engagementindex:GetUpdates:1:rivtabp21
end note

EI_Pull->NTjP: GetLogicalAddressesByServiceContract
NTjP->Tj�nsteadresseringskatalog: GetLogicalAddressesByServiceContract
Tj�nsteadresseringskatalog->NTjP: Lista av logiska adresser
NTjP->EI_Pull: Lista av logiska adresser

note over EI_Pull, NTjP
Lista med logiska adresser som konsumenten f�r g�ra getUpdates p�:
SE2321000016-1K2W
HSA-456
HSA-789
end note

loop f�r varje logisk adress
loop f�r varje service dom�n
loop f�r varje deluppdatering (optionellt)


note right of EI_Pull
Om f�reg�ende h�mtning p�
samma address inte var fullst�ndig,
skicka med id p� den senaste h�mtade posten
f�r att f�  ytterligare uppdateringar.
end note

EI_Pull->NTjP: GetUpdates
NTjP->Producent: GetUpdates

note over EI_Pull, Tj�nsteadresseringskatalog
H�mta f�r:
logicalAddress: SE2321000016-1K2W
tj�nstedom�n: urn:riv:crm:scheduling
vid eller efter tid: 20111010T100000
end note

Producent->NTjP: Lista med uppdateringar
NTjP->EI_Pull: Lista med uppdateringar

EI_Pull->NTjP: Update
NTjP->N EI: Update
N EI->NTjP: Resultat (status + text)
NTjP->EI_Pull:  Resultat (status + text)

note right of EI_Pull
Vid fel, logga felet och g� vidare
med n�sta logiska adress
end note

note right of EI_Pull
Om datan �r fullst�ndig,
g� vidare med n�sta logiska adress
end note

end
end
end
