title Engagemangsindex - Pullfunktion NTjP utan RTP

note over EI_Pull, NTjP
Kolla om N EI svarar
end note

EI_Pull->NTjP: PingForConfiguration
NTjP->N EI: PingForConfiguration
N EI->NTjP: Ping response
NTjP->EI_Pull: Ping response

note over EI_Pull, NTjP
Hämta logiska adresser som konsument får göra getUpdates på:
Konsument HSA ID: HSASERVICES-100M
Tjänstekontrakt: urn:riv:itintegration:engagementindex:GetUpdates:1:rivtabp21
end note

EI_Pull->NTjP: GetLogicalAddressesByServiceContract
NTjP->Tjänsteadresseringskatalog: GetLogicalAddressesByServiceContract

Tjänsteadresseringskatalog->NTjP: Lista av logiska adresser
NTjP->EI_Pull: Lista av logiska adresser

note over EI_Pull, NTjP
Lista med logiska adresser som konsumenten får göra getUpdates på:
SE2321000016-1K2W
HSA-456
HSA-789
end note

loop för varje logisk adress och tjänstedomän
EI_Pull->NTjP: GetUpdates

note over EI_Pull, Tjänsteadresseringskatalog
Hämta för:
logicalAddress: SE2321000016-1K2W
tjänstedomän: urn:riv:crm:scheduling
vid eller efter tid: 20111010T100000
end note

NTjP->Producent: GetUpdates
Producent->NTjP: Lista med uppdateringar
NTjP->EI_Pull: List med uppdateringar

EI_Pull->NTjP: Update
NTjP->N EI: Update
N EI->NTjP: Resultat (status + text)
NTjP->EI_Pull:  Resultat (status + text)

note right of EI_Pull
Vid fel, logga felet och gå vidare
med nästa logiska adress
end note

end